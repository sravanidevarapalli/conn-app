pipeline
{
 agent any 
 tools{
	maven 'maven3.8.1'
    }
 environment {
       _environment_sandbox = 'Sandbox'
       _environment_design = 'Design'
	  when {
        expression {environment._environment_sandbox==Sandbox}
	   _connAppclientId=credentials('connectedAppclientid')
       _connAppclientSecret=credentials('connectedAppclientsecret')
       _connAppgrantType=credentials('connAppgrantType')
	   }
	   when {
       expression {enviroment._environment_design==Design}
       _connAppclientId=credentials('connectedAppclientId-1')
       _connAppclientSecret=credentials('connectedAppclientsecret-1')
       _connAppgrantType=credentials('connAppgrantType')
	   }
	   }
 stages{
    stage('Build Application'){
    steps{
    bat 'mvn clean install -DskipTests'
    }
    }
    
  stage('Deploy Application in Mulesoft Cloudhub'){
   steps{
   bat 'mvn package -DskipTests deploy -DmuleDeploy -Denvironment=${_environment_sandbox} -DconnectedAppClientId=${_connAppclientId} -DconnectedAppClientSecret=${_connAppclientSecret} -DconnectedAppGrantType=${_connAppgrantType}'
   
   }
  }
}
}
